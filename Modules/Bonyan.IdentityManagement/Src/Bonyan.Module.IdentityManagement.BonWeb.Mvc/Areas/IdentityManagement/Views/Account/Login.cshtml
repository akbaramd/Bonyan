@model Bonyan.IdentityManagement.BonWeb.Mvc.Models.Account.LoginInputModel
@inject Microsoft.Extensions.Localization.IStringLocalizer<Bonyan.IdentityManagement.BonWeb.Mvc.IdentityManagementResource> L
@inject Microsoft.Extensions.Localization.IStringLocalizer<Bonyan.Ui.BonWeb.Mvc.BonWebMenuResource> MenuL
@{
    ViewData["Title"] = L["Account:Login"];
    var returnUrl = ViewData["ReturnUrl"] as string ?? "/";
}

<div class="card shadow-sm border-0">
    <div class="card-body p-4 p-md-5">
        <div class="d-flex align-items-center justify-content-between mb-4">
            <div class="fw-semibold text-body">@MenuL["Layout:BonWeb"]</div>
            <span class="badge bg-light text-body border text-nowrap">Secure</span>
        </div>

        <h1 class="h5 mb-2 fw-semibold text-body">@L["Account:WelcomeBack"]</h1>
        <p class="text-body-secondary small mb-4">@L["Account:SignInSubtitle"]</p>

        <form asp-area="IdentityManagement" asp-controller="Account" asp-action="Login" method="post" asp-route-returnUrl="@returnUrl" class="needs-validation" novalidate>
            <input asp-for="ReturnUrl" type="hidden" />
            <div asp-validation-summary="ModelOnly" class="alert alert-danger py-2 small" role="alert"></div>

            <div class="mb-3">
                <label class="form-label fw-medium" asp-for="UserName">@L["Account:UserName"]</label>
                <input asp-for="UserName" type="text" class="form-control" autocomplete="username" />
                <span asp-validation-for="UserName" class="invalid-feedback"></span>
            </div>

            <div class="mb-2">
                <label class="form-label fw-medium" asp-for="Password">@L["Account:Password"]</label>
                <div class="input-group has-validation">
                    <input asp-for="Password" type="password" class="form-control" autocomplete="current-password" id="loginPassword" />
                    <button class="btn btn-outline-secondary" type="button" id="togglePw" aria-label="@L["Account:ShowPassword"]" data-show="@L["Account:Show"]" data-hide="@L["Account:Hide"]" data-aria-show="@L["Account:ShowPassword"]" data-aria-hide="@L["Account:HidePassword"]">@L["Account:Show"]</button>
                    <span asp-validation-for="Password" class="invalid-feedback"></span>
                </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-4">
                <div class="form-check">
                    <input asp-for="RememberMe" class="form-check-input" type="checkbox" id="remember" />
                    <label class="form-check-label small" for="remember">@L["Account:RememberMe"]</label>
                </div>
                <a class="auth-link small text-decoration-none" asp-area="IdentityManagement" asp-controller="Account" asp-action="ForgotPassword">@L["Account:ForgotPassword"]</a>
            </div>

            <button class="btn btn-primary w-100 py-2 fw-medium" type="submit">@L["Account:SignIn"]</button>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        (function () {
            var toggle = document.getElementById('togglePw');
            var pw = document.getElementById('loginPassword');
            if (toggle && pw) {
                toggle.addEventListener('click', function () {
                    var isPw = pw.type === 'password';
                    pw.type = isPw ? 'text' : 'password';
                    toggle.textContent = isPw ? toggle.getAttribute('data-hide') : toggle.getAttribute('data-show');
                    toggle.setAttribute('aria-label', isPw ? toggle.getAttribute('data-aria-hide') : toggle.getAttribute('data-aria-show'));
                });
            }
            var form = document.querySelector('.needs-validation');
            if (form) {
                form.addEventListener('submit', function (e) {
                    if (!form.checkValidity()) {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                    form.classList.add('was-validated');
                });
            }
        })();
    </script>
}
