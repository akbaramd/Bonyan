@model Bonyan.Novino.Web.Models.LogoutViewModel
@{
    ViewData["Title"] = "تأیید خروج";
    Layout = null;
    
    // Security headers
    Context.Response.Headers.Add("X-Frame-Options", "DENY");
    Context.Response.Headers.Add("X-Content-Type-Options", "nosniff");
    Context.Response.Headers.Add("X-XSS-Protection", "1; mode=block");
    Context.Response.Headers.Add("Referrer-Policy", "strict-origin-when-cross-origin");
    Context.Response.Headers.Add("Content-Security-Policy", "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' https:;");
}

<!DOCTYPE html>
<html lang="fa" dir="rtl" data-layout="vertical" data-topbar="light" data-sidebar="ladylip" data-sidebar-size="lg">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="تأیید خروج از پنل مدیریت بنیان"/>
    <meta name="robots" content="noindex, nofollow"/>
    <title>@ViewData["Title"] - پنل مدیریت بنیان</title>
    
    <!-- CSS Assets in Head -->
    <css-assets location="Head"></css-assets>
    <js-assets location="Head"></js-assets>
</head>
<body>

    <!-- auth-page wrapper -->
    <div class="auth-page-wrapper auth-bg-cover py-5 d-flex justify-content-center align-items-center min-vh-100">
        <div class="bg-overlay"></div>
        <!-- auth-page content -->
        <div class="auth-page-content overflow-hidden pt-lg-5">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card overflow-hidden card-bg-fill galaxy-border-none">
                            <div class="row justify-content-center g-0">
                                <div class="col-lg-6">
                                    <div class="p-lg-5 p-4 auth-one-bg h-100">
                                        <div class="bg-overlay"></div>
                                        <div class="position-relative h-100 d-flex flex-column">
                                            <div class="mb-4">
                                                <a href="@Url.Action("Index", "Home")" class="d-block">
                                                    <img src="~/assets/images/logo-light.png" alt="لوگوی بنیان" height="18">
                                                </a>
                                            </div>
                                            <div class="mt-auto">
                                                <div class="mb-3">
                                                    <i class="ri-double-quotes-l display-4 text-success"></i>
                                                </div>

                                                <div id="qoutescarouselIndicators" class="carousel slide" data-bs-ride="carousel">
                                                    <div class="carousel-indicators">
                                                        <button type="button" data-bs-target="#qoutescarouselIndicators" data-bs-slide-to="0" class="active"
                                                                aria-current="true" aria-label="اسلاید ۱"></button>
                                                        <button type="button" data-bs-target="#qoutescarouselIndicators" data-bs-slide-to="1"
                                                                aria-label="اسلاید ۲"></button>
                                                        <button type="button" data-bs-target="#qoutescarouselIndicators" data-bs-slide-to="2"
                                                                aria-label="اسلاید ۳"></button>
                                                    </div>
                                                    <div class="carousel-inner text-center text-white pb-5">
                                                        <div class="carousel-item active">
                                                            <p class="fs-15 fst-italic">" کد تمیز، طراحی زیبا و قابل شخصی‌سازی آسان. بسیار متشکریم! "</p>
                                                        </div>
                                                        <div class="carousel-item">
                                                            <p class="fs-15 fst-italic">" قالب واقعاً عالی است با پشتیبانی مشتری فوق‌العاده."</p>
                                                        </div>
                                                        <div class="carousel-item">
                                                            <p class="fs-15 fst-italic">" عالی! کد تمیز، طراحی زیبا و قابل شخصی‌سازی آسان. بسیار متشکریم! "</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- end carousel -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- end col -->

                                <div class="col-lg-6">
                                    <div class="p-lg-5 p-4">
                                        <div class="text-center">
                                            <lord-icon
                                                src="https://cdn.lordicon.com/gsqxdxog.json"
                                                trigger="loop"
                                                colors="primary:#f7b84b,secondary:#f06548"
                                                style="width:120px;height:120px">
                                            </lord-icon>
                                        </div>

                                        <div class="mt-4 pt-2 text-center">
                                            <h4>آیا مطمئن هستید؟</h4>
                                            <p class="text-muted">آیا مطمئن هستید که می‌خواهید از سیستم خارج شوید؟</p>
                                            
                                            <div class="user-info bg-light rounded p-3 mb-4">
                                                <div class="d-flex align-items-center">
                                                    <img class="rounded-circle me-3" src="~/assets/images/users/avatar-1.jpg" 
                                                         alt="User Avatar" width="48" height="48">
                                                    <div class="text-start">
                                                        <h6 class="mb-1">@Model.UserName</h6>
                                                        <small class="text-muted">کاربر سیستم</small>
                                                    </div>
                                                </div>
                                            </div>

                                            <form asp-action="Logout" asp-controller="Account" method="post" id="logoutForm">
                                                <input type="hidden" asp-for="ReturnUrl" />
                                                <input type="hidden" asp-for="IsConfirmed" value="true" />
                                                
                                                <div class="d-flex gap-2 justify-content-center">
                                                    <button type="button" class="btn btn-light" id="cancelButton">
                                                        <i class="ri-close-line me-1"></i>
                                                        انصراف
                                                    </button>
                                                    <button type="submit" class="btn btn-danger" id="logoutButton">
                                                        <i class="ri-logout-box-r-line me-1"></i>
                                                        <span id="logoutButtonText">خروج</span>
                                                    </button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <!-- end col -->
                            </div>
                            <!-- end row -->
                        </div>
                        <!-- end card -->
                    </div>
                    <!-- end col -->
                </div>
                <!-- end row -->
            </div>
            <!-- end container -->
        </div>
        <!-- end auth page content -->
        <!-- footer -->
        <footer class="footer galaxy-border-none">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="text-center">
                            <p class="mb-0">&copy; <script>document.write(new Date().getFullYear())</script> بنیان. تمامی حقوق محفوظ است.</p>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- end Footer -->
    </div>
    <!-- end auth-page-wrapper -->

    <!-- JavaScript Assets in Footer -->
    <js-assets location="Footer"></js-assets>

    <script>
        (function() {
            'use strict';

            // DOM elements
            const form = document.getElementById('logoutForm');
            const logoutButton = document.getElementById('logoutButton');
            const logoutButtonText = document.getElementById('logoutButtonText');
            const cancelButton = document.getElementById('cancelButton');

            // Initialize
            function initialize() {
                // Auto-focus on logout button for accessibility
                logoutButton.focus();

                // Form submission handler
                form.addEventListener('submit', handleFormSubmit);

                // Cancel button handler
                cancelButton.addEventListener('click', handleCancel);

                // Keyboard navigation
                document.addEventListener('keydown', handleKeyNavigation);
            }

            function handleFormSubmit(event) {
                event.preventDefault();

                // Show loading state
                setLoadingState(true);

                // Submit form
                form.submit();
            }

            function handleCancel(event) {
                event.preventDefault();
                
                // Get return URL from hidden input
                const returnUrlInput = document.querySelector('input[name="ReturnUrl"]');
                const returnUrl = returnUrlInput ? returnUrlInput.value : null;
                
                // Redirect to return URL or home page
                if (returnUrl && returnUrl !== '/') {
                    window.location.href = returnUrl;
                } else {
                    window.location.href = '/';
                }
            }

            function setLoadingState(loading) {
                if (loading) {
                    logoutButton.disabled = true;
                    logoutButtonText.textContent = 'در حال خروج...';
                    logoutButton.innerHTML = '<i class="ri-loader-4-line me-1 animate-spin"></i><span>در حال خروج...</span>';
                } else {
                    logoutButton.disabled = false;
                    logoutButtonText.textContent = 'خروج';
                    logoutButton.innerHTML = '<i class="ri-logout-box-r-line me-1"></i><span>خروج</span>';
                }
            }

            function handleKeyNavigation(event) {
                if (event.key === 'Escape') {
                    handleCancel(event);
                } else if (event.key === 'Enter' && document.activeElement === logoutButton) {
                    form.dispatchEvent(new Event('submit'));
                }
            }

            // Security features
            function initializeSecurity() {
                // Prevent form resubmission
                if (window.history.replaceState) {
                    window.history.replaceState(null, null, window.location.href);
                }

                // Disable right-click context menu
                document.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                });

                // Disable text selection
                document.addEventListener('selectstart', function(e) {
                    e.preventDefault();
                });
            }

            // Theme management
            function initializeTheme() {
                const savedTheme = localStorage.getItem('admin-theme') || 'light';
                document.documentElement.setAttribute('data-bs-theme', savedTheme);
            }

            // Initialize everything when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initialize);
            } else {
                initialize();
            }

            function initialize() {
                initializeTheme();
                initializeSecurity();
            }

        })();
    </script>
</body>
</html> 